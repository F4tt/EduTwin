# Há»† THá»NG EDUTWIN - TÃ€I LIá»†U CHI TIáº¾T

## ğŸ“‹ THÃ”NG TIN Dá»° ÃN

**TÃªn dá»± Ã¡n:** EduTwin - Há»‡ thá»‘ng Há»— trá»£ Há»c táº­p ThÃ´ng minh  
**PhiÃªn báº£n:** 1.0.0  
**NgÃ y hoÃ n thÃ nh:** November 2025  
**Repository:** https://github.com/F4tt/EduTwin  

---

## ğŸ¯ Tá»”NG QUAN Há»† THá»NG

### 1.1. Giá»›i thiá»‡u

EduTwin lÃ  má»™t há»‡ thá»‘ng web application thÃ´ng minh Ä‘Æ°á»£c thiáº¿t káº¿ Ä‘á»ƒ há»— trá»£ há»c sinh trung há»c phá»• thÃ´ng (THPT) trong viá»‡c theo dÃµi, dá»± Ä‘oÃ¡n vÃ  cáº£i thiá»‡n káº¿t quáº£ há»c táº­p. Há»‡ thá»‘ng káº¿t há»£p cÃ´ng nghá»‡ Machine Learning, Natural Language Processing vÃ  Chatbot AI Ä‘á»ƒ cung cáº¥p tráº£i nghiá»‡m há»c táº­p cÃ¡ nhÃ¢n hÃ³a.

### 1.2. Má»¥c tiÃªu

- **Dá»± Ä‘oÃ¡n Ä‘iá»ƒm sá»‘:** Sá»­ dá»¥ng 3 thuáº­t toÃ¡n ML (KNN, Kernel Regression, LWLR) Ä‘á»ƒ dá»± Ä‘oÃ¡n Ä‘iá»ƒm sá»‘ cÃ¡c mÃ´n há»c
- **Chatbot thÃ´ng minh:** TÃ­ch há»£p Gemini API Ä‘á»ƒ tÆ° váº¥n há»c táº­p vÃ  cáº­p nháº­t thÃ´ng tin
- **Theo dÃµi tiáº¿n Ä‘á»™:** Visualize káº¿t quáº£ há»c táº­p qua cÃ¡c biá»ƒu Ä‘á»“ vÃ  dashboard
- **CÃ¡ nhÃ¢n hÃ³a:** Há»c táº­p tá»« thÃ³i quen vÃ  sá»Ÿ thÃ­ch cá»§a ngÆ°á»i dÃ¹ng
- **PhÃ¢n tÃ­ch dá»¯ liá»‡u:** Cung cáº¥p insights vá» dataset vÃ  benchmark so sÃ¡nh

### 1.3. Äá»‘i tÆ°á»£ng sá»­ dá»¥ng

- **Há»c sinh THPT:** Lá»›p 10, 11, 12 - theo dÃµi vÃ  dá»± Ä‘oÃ¡n káº¿t quáº£ há»c táº­p
- **GiÃ¡o viÃªn/Phá»¥ huynh:** Theo dÃµi tiáº¿n Ä‘á»™ há»c sinh
- **Developer/Admin:** Quáº£n lÃ½ dataset, cáº¥u hÃ¬nh mÃ´ hÃ¬nh ML, Ä‘Ã¡nh giÃ¡ hiá»‡u suáº¥t

---

## ğŸ—ï¸ KIáº¾N TRÃšC Há»† THá»NG

### 2.1. SÆ¡ Ä‘á»“ Kiáº¿n trÃºc Tá»•ng quan

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                      CLIENT LAYER                            â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”   â”‚
â”‚  â”‚  React Frontend (Vite)                                â”‚   â”‚
â”‚  â”‚  - Single Page Application                            â”‚   â”‚
â”‚  â”‚  - Real-time updates via WebSocket                    â”‚   â”‚
â”‚  â”‚  - Responsive UI with Chart.js & Recharts             â”‚   â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜   â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                            â†• HTTP/WebSocket
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                    APPLICATION LAYER                         â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”   â”‚
â”‚  â”‚  FastAPI Backend                                      â”‚   â”‚
â”‚  â”‚  â”œâ”€â”€ REST API Endpoints                               â”‚   â”‚
â”‚  â”‚  â”œâ”€â”€ WebSocket Manager (Socket.IO)                    â”‚   â”‚
â”‚  â”‚  â”œâ”€â”€ Authentication & Authorization                   â”‚   â”‚
â”‚  â”‚  â””â”€â”€ Business Logic Services                          â”‚   â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜   â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                            â†•
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                     SERVICE LAYER                            â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”‚
â”‚  â”‚  ML Service    â”‚  â”‚ Chatbot Serviceâ”‚  â”‚  LLM Providerâ”‚  â”‚
â”‚  â”‚  - KNN         â”‚  â”‚ - Intent Detectâ”‚  â”‚  - Gemini APIâ”‚  â”‚
â”‚  â”‚  - KR          â”‚  â”‚ - Conversation â”‚  â”‚  - Chat Gen  â”‚  â”‚
â”‚  â”‚  - LWLR        â”‚  â”‚ - Personalize  â”‚  â”‚  - Retry/Log â”‚  â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                            â†•
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                      DATA LAYER                              â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”‚
â”‚  â”‚ PostgreSQL   â”‚  â”‚    Redis     â”‚  â”‚  External APIs   â”‚  â”‚
â”‚  â”‚ - User data  â”‚  â”‚ - Sessions   â”‚  â”‚  - Gemini API    â”‚  â”‚
â”‚  â”‚ - Scores     â”‚  â”‚ - Cache      â”‚  â”‚                  â”‚  â”‚
â”‚  â”‚ - ML samples â”‚  â”‚              â”‚  â”‚                  â”‚  â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                            â†•
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                  MONITORING LAYER                            â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”‚
â”‚  â”‚ Prometheus   â”‚  â”‚   Grafana    â”‚  â”‚  Loki + Promtail â”‚  â”‚
â”‚  â”‚ - Metrics    â”‚  â”‚ - Dashboards â”‚  â”‚  - Logs          â”‚  â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

### 2.2. Luá»“ng dá»¯ liá»‡u chÃ­nh

**A. Dá»± Ä‘oÃ¡n Ä‘iá»ƒm sá»‘:**
```
User Input â†’ API Endpoint â†’ Prediction Service â†’ ML Algorithm 
â†’ Database Update â†’ WebSocket Notification â†’ UI Update
```

**B. Chatbot conversation:**
```
User Message â†’ WebSocket/API â†’ Intent Detection â†’ Chatbot Service 
â†’ Gemini API â†’ Response Generation â†’ Pending Updates (if needed) 
â†’ WebSocket â†’ Chat UI
```

**C. Import dataset:**
```
Excel File â†’ Upload Endpoint â†’ Excel Importer â†’ Data Validation 
â†’ Database Insert â†’ ML Pipeline Trigger â†’ Recalculate Predictions
```

---

## ğŸ§© CÃC THÃ€NH PHáº¦N CHÃNH

### 3.1. Frontend (React + Vite)

**CÃ´ng nghá»‡:**
- React 19.2.0 - UI framework
- Vite 7.2.4 - Build tool & dev server
- React Router 7.9.6 - Client-side routing
- Chart.js 4.5.1 & Recharts 3.4.1 - Data visualization
- Socket.IO Client 4.8.1 - Real-time communication
- Axios 1.13.2 - HTTP client
- React Markdown 10.1.0 - Markdown rendering
- Framer Motion 12.23.24 - Animations

**Cáº¥u trÃºc thÆ° má»¥c:**
```
frontend_react/
â”œâ”€â”€ src/
â”‚   â”œâ”€â”€ pages/          # CÃ¡c trang chÃ­nh
â”‚   â”‚   â”œâ”€â”€ Auth.jsx           # ÄÄƒng nháº­p/Ä‘Äƒng kÃ½
â”‚   â”‚   â”œâ”€â”€ FirstLogin.jsx     # Onboarding cho user má»›i
â”‚   â”‚   â”œâ”€â”€ Chatbot.jsx        # Giao diá»‡n chatbot
â”‚   â”‚   â”œâ”€â”€ DataViz.jsx        # Dashboard & biá»ƒu Ä‘á»“
â”‚   â”‚   â”œâ”€â”€ StudyUpdate.jsx    # Cáº­p nháº­t Ä‘iá»ƒm
â”‚   â”‚   â”œâ”€â”€ LearningGoals.jsx  # Quáº£n lÃ½ má»¥c tiÃªu
â”‚   â”‚   â”œâ”€â”€ Settings.jsx       # CÃ i Ä‘áº·t tÃ i khoáº£n
â”‚   â”‚   â””â”€â”€ Developer.jsx      # Quáº£n trá»‹ ML
â”‚   â”œâ”€â”€ components/     # Components tÃ¡i sá»­ dá»¥ng
â”‚   â”‚   â”œâ”€â”€ Layout.jsx         # Layout chung
â”‚   â”‚   â””â”€â”€ NotificationBell.jsx
â”‚   â”œâ”€â”€ context/        # React Context
â”‚   â”‚   â”œâ”€â”€ AuthContext.jsx    # Quáº£n lÃ½ authentication
â”‚   â”‚   â””â”€â”€ WebSocketContext.jsx # Quáº£n lÃ½ WebSocket
â”‚   â”œâ”€â”€ api/            # API client
â”‚   â”‚   â””â”€â”€ axiosClient.js
â”‚   â”œâ”€â”€ utils/          # Utilities
â”‚   â”‚   â”œâ”€â”€ eventBus.js        # Event emitter
â”‚   â”‚   â””â”€â”€ validation.js
â”‚   â””â”€â”€ App.jsx         # Root component
â”œâ”€â”€ public/             # Static assets
â”œâ”€â”€ Dockerfile          # Development Docker image
â”œâ”€â”€ Dockerfile.prod     # Production Docker image
â””â”€â”€ package.json
```

**TÃ­nh nÄƒng chÃ­nh:**

1. **Authentication & Authorization:**
   - JWT-based authentication
   - Protected routes
   - Role-based access (user/developer/admin)
   - First-time login flow

2. **Real-time Communication:**
   - WebSocket connection via Socket.IO
   - Live chat updates
   - Score prediction notifications
   - Typing indicators

3. **Data Visualization:**
   - Line charts: Xu hÆ°á»›ng Ä‘iá»ƒm theo thá»i gian
   - Bar charts: So sÃ¡nh actual vs predicted
   - Radar charts: PhÃ¢n tÃ­ch Ä‘a mÃ´n há»c
   - Progress tracking
   - Benchmark comparisons

4. **Chatbot Interface:**
   - Multi-session support
   - Markdown rendering
   - Pending confirmation UI
   - Score update suggestions
   - Profile editing via chat

5. **Developer Dashboard:**
   - ML model selection (KNN/KR/LWLR)
   - Parameter tuning
   - Dataset upload (Excel)
   - Model evaluation & metrics
   - Pipeline management

### 3.2. Backend (FastAPI + Python)

**CÃ´ng nghá»‡:**
- FastAPI - Modern web framework
- SQLAlchemy - ORM
- PostgreSQL 15 - Relational database
- Redis 7 - Session & caching
- Uvicorn/Gunicorn - ASGI server
- Socket.IO - WebSocket support
- Prometheus Client - Metrics
- Python JSON Logger - Structured logging

**Machine Learning Stack:**
- scikit-learn - ML algorithms & utilities
- numpy - Numerical computing
- scipy - Scientific computing
- pandas - Data manipulation

**Cáº¥u trÃºc thÆ° má»¥c:**
```
backend/
â”œâ”€â”€ api/                # API route handlers
â”‚   â”œâ”€â”€ auth.py              # Authentication endpoints
â”‚   â”œâ”€â”€ chatbot.py           # Chatbot API
â”‚   â”œâ”€â”€ study.py             # Study scores CRUD
â”‚   â”œâ”€â”€ learning_goals.py    # Goals management
â”‚   â”œâ”€â”€ user.py              # User profile
â”‚   â””â”€â”€ developer.py         # Admin/developer tools
â”œâ”€â”€ services/           # Business logic
â”‚   â”œâ”€â”€ chatbot_service.py       # Chat orchestration
â”‚   â”œâ”€â”€ llm_provider.py          # Gemini API integration
â”‚   â”œâ”€â”€ intent_detection.py      # NLP intent parsing
â”‚   â”œâ”€â”€ personalization_learner.py
â”‚   â”œâ”€â”€ educational_knowledge.py # Domain knowledge
â”‚   â”œâ”€â”€ excel_importer.py        # Dataset import
â”‚   â”œâ”€â”€ dataset_analyzer.py      # Statistical analysis
â”‚   â”œâ”€â”€ model_evaluator.py       # ML model evaluation
â”‚   â””â”€â”€ ml_version_manager.py    # Version tracking
â”œâ”€â”€ ml/                 # Machine Learning
â”‚   â”œâ”€â”€ prediction_service.py    # Main prediction engine
â”‚   â””â”€â”€ knn_common.py            # Feature engineering
â”œâ”€â”€ core/               # Core utilities
â”‚   â”œâ”€â”€ logging_config.py        # Structured logging
â”‚   â”œâ”€â”€ metrics.py               # Prometheus metrics
â”‚   â”œâ”€â”€ metrics_collector.py     # System metrics
â”‚   â”œâ”€â”€ websocket_manager.py     # WebSocket handling
â”‚   â””â”€â”€ study_constants.py       # Domain constants
â”œâ”€â”€ db/                 # Database
â”‚   â”œâ”€â”€ database.py              # DB connection
â”‚   â””â”€â”€ models.py                # SQLAlchemy models
â”œâ”€â”€ utils/              # Utilities
â”‚   â””â”€â”€ session_utils.py         # Session management
â”œâ”€â”€ alembic/            # Database migrations
â””â”€â”€ main.py             # Application entry point
```

**Database Schema (PostgreSQL):**

```sql
-- Users table
users:
  - id (PK)
  - username (unique)
  - hashed_password
  - first_name, last_name, email, phone, address, age
  - preferences (JSON)
  - current_grade
  - role (user/developer/admin)
  - first_login_completed
  - ml_config_version

-- Study scores table
study_scores:
  - id (PK)
  - user_id (FK)
  - subject, grade_level, semester
  - actual_score, predicted_score
  - actual_source, predicted_source
  - actual_status, predicted_status
  - actual_updated_at, predicted_updated_at
  - UNIQUE(user_id, subject, grade_level, semester)

-- KNN reference samples (shared dataset)
knn_reference_samples:
  - id (PK)
  - feature_data (JSON) - all subject scores
  - user_id (FK, nullable) - for future user-specific data
  - source, metadata

-- Chat sessions
chat_sessions:
  - id (PK)
  - user_id (FK)
  - title
  - created_at, updated_at

-- Chat messages
chat_messages:
  - id (PK)
  - session_id (FK)
  - role (user/assistant/system)
  - content (text)
  - metadata (JSON)
  - created_at

-- Pending updates (for chat confirmations)
pending_updates:
  - id (PK)
  - user_id (FK)
  - update_type (profile/score/document)
  - field, old_value, new_value
  - metadata (JSON)
  - created_at

-- ML model configuration
ml_model_configs:
  - id (PK)
  - active_model (knn/kernel_regression/lwlr)
  - version
  - updated_by (FK)
  - updated_at

-- Model parameters
model_parameters:
  - id (PK)
  - knn_n (default: 15)
  - kr_bandwidth (default: 1.25)
  - lwlr_tau (default: 3.0)
  - version
  - updated_by (FK)
  - updated_at

-- Learning goals
learning_goals:
  - id (PK)
  - user_id (FK)
  - title, description
  - target_date, priority, status
  - metadata (JSON)

-- Data import logs
data_import_logs:
  - id (PK)
  - uploaded_by (FK)
  - filename
  - total_rows, imported_rows, skipped_rows
  - error_message, metadata
  - created_at
```

---

## ğŸ¤– MACHINE LEARNING - 3 MÃ” HÃŒNH Dá»° ÄOÃN

### 4.1. Tá»•ng quan ML Pipeline

**Input:** Äiá»ƒm sá»‘ hiá»‡n táº¡i cá»§a há»c sinh (actual scores)  
**Output:** Äiá»ƒm dá»± Ä‘oÃ¡n cho cÃ¡c mÃ´n/ká»³ chÆ°a cÃ³ Ä‘iá»ƒm  
**Dataset:** Reference samples tá»« KNNReferenceSample table (shared)

**Feature Engineering:**
- Feature key format: `{subject}|{semester}|{grade}`
- VÃ­ dá»¥: `Toan|1|10` (ToÃ¡n há»c ká»³ 1 lá»›p 10)
- Tá»•ng features: 9 mÃ´n Ã— 2 há»c ká»³ Ã— 3 lá»›p = 54 features/sample

### 4.2. MÃ´ hÃ¬nh 1: K-Nearest Neighbors (KNN)

**File:** `backend/ml/prediction_service.py` - `_predict_with_knn()`

**NguyÃªn lÃ½:**
- TÃ¬m k lÃ¡ng giá»ng gáº§n nháº¥t dá»±a trÃªn Euclidean distance
- Dá»± Ä‘oÃ¡n = weighted average cá»§a Ä‘iá»ƒm sá»‘ k lÃ¡ng giá»ng
- Weight = 1 / (distance + Îµ) Ä‘á»ƒ trÃ¡nh division by zero

**Thuáº­t toÃ¡n:**
```python
for each target_key:
    neighbors = []
    for sample in dataset:
        # Calculate Euclidean distance based on overlapping features
        overlap = actual_keys âˆ© sample.keys()
        distance = sqrt(Î£(sample[key] - actual[key])Â² for key in overlap)
        neighbors.append((distance, sample))
    
    # Sort and select top k
    neighbors.sort(by distance)
    top_k = neighbors[:k]
    
    # Weighted prediction
    numerator = Î£(weight_i Ã— value_i)
    denominator = Î£(weight_i)
    prediction = numerator / denominator
```

**Tham sá»‘:**
- `knn_n`: Sá»‘ lÃ¡ng giá»ng (default: 15)
- CÃ³ thá»ƒ Ä‘iá»u chá»‰nh qua Developer Dashboard

**Æ¯u Ä‘iá»ƒm:**
- ÄÆ¡n giáº£n, dá»… hiá»ƒu
- KhÃ´ng cáº§n training phase
- Hoáº¡t Ä‘á»™ng tá»‘t vá»›i small-medium datasets

**NhÆ°á»£c Ä‘iá»ƒm:**
- Sensitive to k selection
- Tá»‘n computational cost khi predict

### 4.3. MÃ´ hÃ¬nh 2: Kernel Regression (Nadaraya-Watson)

**File:** `backend/ml/prediction_service.py` - `_predict_with_kernel_regression()`

**NguyÃªn lÃ½:**
- Sá»­ dá»¥ng Gaussian kernel Ä‘á»ƒ weight táº¥t cáº£ samples
- KhÃ´ng giá»›i háº¡n k neighbors, sá»­ dá»¥ng toÃ n bá»™ dataset
- Kernel function: K(x) = exp(-dÂ²/(2ÏƒÂ²))

**Thuáº­t toÃ¡n:**
```python
for each target_key:
    numerator = 0
    denominator = 0
    
    for sample in dataset:
        # Calculate Euclidean distance
        distance = euclidean(actual_vec, sample_vec)
        
        # Gaussian kernel weight
        weight = exp(-(distanceÂ²) / (2 Ã— bandwidthÂ²))
        
        numerator += weight Ã— sample[target_key]
        denominator += weight
    
    prediction = numerator / denominator
```

**Tham sá»‘:**
- `kr_bandwidth` (Ïƒ): Kernel bandwidth (default: 1.25)
- Bandwidth cÃ ng lá»›n â†’ smooth hÆ¡n, Ã­t sensitive vá»›i outliers
- Bandwidth cÃ ng nhá» â†’ fit cháº·t hÆ¡n, dá»… overfit

**Æ¯u Ä‘iá»ƒm:**
- Smooth predictions
- Sá»­ dá»¥ng toÃ n bá»™ thÃ´ng tin tá»« dataset
- Robust vá»›i noise

**NhÆ°á»£c Ä‘iá»ƒm:**
- Slower than KNN (compute táº¥t cáº£ samples)
- Sensitive to bandwidth parameter

### 4.4. MÃ´ hÃ¬nh 3: Locally Weighted Linear Regression (LWLR)

**File:** `backend/ml/prediction_service.py` - `_predict_with_lwlr()`

**NguyÃªn lÃ½:**
- Káº¿t há»£p KNN vÃ  Linear Regression
- TÃ¬m k lÃ¡ng giá»ng gáº§n nháº¥t, sau Ä‘Ã³ fit weighted linear regression
- Sá»­ dá»¥ng tricube kernel Ä‘á»ƒ tÃ­nh weights

**Thuáº­t toÃ¡n:**
```python
for each target_key:
    # Find k nearest neighbors that have target_key
    neighbors = find_k_nearest(actual_map, dataset, k)
    
    # Calculate bandwidth from max distance
    max_distance = neighbors[-1].distance
    bandwidth = max_distance / tau
    
    # Compute tricube weights
    for neighbor in neighbors:
        normalized_dist = distance / bandwidth
        if normalized_dist < 1.0:
            weight = (1 - normalized_distÂ³)Â³
        else:
            weight = 0.0
    
    # Fit weighted linear regression
    lr = LinearRegression()
    lr.fit(X_neighbors, y_neighbors, sample_weight=weights)
    
    # Predict
    prediction = lr.predict(actual_vec)
```

**Tham sá»‘:**
- `lwlr_tau`: Äiá»u chá»‰nh window size (default: 3.0)
- Tau cÃ ng lá»›n â†’ bandwidth cÃ ng nhá» â†’ locality cÃ ng máº¡nh
- Tau cÃ ng nhá» â†’ bandwidth cÃ ng lá»›n â†’ global hÆ¡n

**Æ¯u Ä‘iá»ƒm:**
- Capture linear trends trong local regions
- Flexible, adaptive to data structure
- Tá»‘t cho non-linear relationships

**NhÆ°á»£c Ä‘iá»ƒm:**
- Computationally expensive (fit LR má»—i prediction)
- Cáº§n Ã­t nháº¥t 2 neighbors Ä‘á»ƒ fit regression
- Sensitive to tau parameter

### 4.5. Model Evaluation System

**File:** `backend/services/model_evaluator.py`

**2 Evaluation Tasks:**

1. **Task 1:** Predict Grade 12 from Grades 10-11
   - Input features: 36 scores (9 mÃ´n Ã— 2 ká»³ Ã— 2 lá»›p)
   - Target features: 18 scores (9 mÃ´n Ã— 2 ká»³ Ã— lá»›p 12)

2. **Task 2:** Predict Grade 11 from Grade 10
   - Input features: 18 scores (9 mÃ´n Ã— 2 ká»³ Ã— lá»›p 10)
   - Target features: 18 scores (9 mÃ´n Ã— 2 ká»³ Ã— lá»›p 11)

**Metrics:**
- **MAE** (Mean Absolute Error): Trung bÃ¬nh Ä‘á»™ lá»‡ch tuyá»‡t Ä‘á»‘i
- **MSE** (Mean Squared Error): Trung bÃ¬nh bÃ¬nh phÆ°Æ¡ng Ä‘á»™ lá»‡ch
- **RMSE** (Root Mean Squared Error): CÄƒn báº­c 2 cá»§a MSE
- **Accuracy@0.5**: % predictions sai sá»‘ â‰¤ 0.5 Ä‘iá»ƒm
- **Accuracy@1.0**: % predictions sai sá»‘ â‰¤ 1.0 Ä‘iá»ƒm

**Methodology:**
- 80/20 train-test split
- Only use complete records (cÃ³ Ä‘á»§ input + target)
- Report metrics cho cáº£ 2 tasks vÃ  3 models

**Endpoint:** `/developer/evaluate-models`

---

## ğŸ¤– CHATBOT & GEMINI API INTEGRATION

### 5.1. LLM Provider Service

**File:** `backend/services/llm_provider.py`

**Gemini API Configuration:**
```python
LLM_PROVIDER=gemini
LLM_API_URL=https://generativelanguage.googleapis.com/v1beta/models/gemini-2.5-flash:generateContent
LLM_API_KEY=<your-api-key>
LLM_MODEL=gemini-2.5-flash
LLM_TIMEOUT_SECONDS=90
```

**Features:**
- **Format conversion:** OpenAI-style messages â†’ Gemini contents format
  - `role: "system"` â†’ `role: "user"` (Gemini khÃ´ng há»— trá»£ system role)
  - `role: "user"` â†’ `role: "user"`
  - `role: "assistant"` â†’ `role: "model"`

- **Retry mechanism:** 
  - Max retries: 3
  - Exponential backoff: 0.8s Ã— 2^(attempt-1)
  - Auto-retry on 429 (rate limit) vÃ  5xx errors

- **Concurrency control:**
  - Semaphore limit: 6 concurrent requests
  - Prevent API overload

- **Response parsing:**
  - Extract tá»« `candidates[0].content.parts[0].text`
  - Fallback parsing cho nhiá»u response formats

- **Metrics tracking:**
  - Request count, duration, errors
  - Token usage (input/output tokens)
  - Exported to Prometheus

### 5.2. Intent Detection

**File:** `backend/services/intent_detection.py`

Há»‡ thá»‘ng phÃ¡t hiá»‡n Ã½ Ä‘á»‹nh cá»§a user tá»« chat message:

**1. Score Update Intent:**
```python
detect_score_update_intent(message) â†’ ScoreUpdateIntent
```
- Pattern matching: "Ä‘iá»ƒm toÃ¡n", "mÃ´n lÃ½", "há»c ká»³ 1"
- Extract: subject, semester, grade, score value
- Normalize Vietnamese diacritics

**2. Profile Update Intent:**
```python
detect_profile_update_intent(message) â†’ dict
```
- Detect: first_name, last_name, email, phone updates
- Pattern: "tÃªn tÃ´i lÃ ", "email cá»§a tÃ´i", "sá»‘ Ä‘iá»‡n thoáº¡i"

**3. Personalization Intent:**
```python
detect_personalization_intent(message) â†’ bool
```
- Keywords: "há»c nhÆ° tháº¿ nÃ o", "phÆ°Æ¡ng phÃ¡p", "lá»i khuyÃªn"

**4. Confirmation Intent:**
```python
detect_confirmation_intent(message) â†’ bool
```
- Patterns: "Ä‘Ãºng", "ok", "xÃ¡c nháº­n", "Ä‘á»“ng Ã½"

**5. Cancellation Intent:**
```python
detect_cancellation_intent(message) â†’ bool
```
- Patterns: "khÃ´ng", "há»§y", "thÃ´i", "sai rá»“i"

### 5.3. Chatbot Service Workflow

**File:** `backend/services/chatbot_service.py`

**Main function:** `generate_chat_response(db, user_id, message, session_id)`

**Workflow:**
```
1. Check pending updates
   â”œâ”€ If has pending â†’ Ask for confirmation
   â””â”€ Detect confirmation/cancellation intent

2. Detect score update intent
   â”œâ”€ Parse subject/semester/grade/score
   â”œâ”€ Validate score (0-10 range)
   â”œâ”€ Create pending update
   â””â”€ Ask user to confirm

3. Detect profile update intent
   â”œâ”€ Extract field & new value
   â”œâ”€ Create pending update
   â””â”€ Ask user to confirm

4. Detect personalization intent
   â”œâ”€ Analyze chat session
   â””â”€ Learn preferences (PersonalizationLearner)

5. General conversation
   â”œâ”€ Build context from user profile
   â”œâ”€ Include study scores & predictions
   â”œâ”€ Add dataset benchmark statistics
   â”œâ”€ Add educational knowledge
   â””â”€ Call Gemini API with enriched context
```

**Context Building:**
- User profile summary
- Recent study scores (actual + predicted)
- Dataset statistics (mean, median, percentiles)
- Score classifications (Xuáº¥t sáº¯c/Giá»i/KhÃ¡/Trung bÃ¬nh)
- GPA calculations
- Learning preferences

### 5.4. Personalization Learner

**File:** `backend/services/personalization_learner.py`

Analyze chat patterns Ä‘á»ƒ há»c preferences:

**Detected Patterns:**
1. **Communication style:**
   - Short messages (<20 chars) â†’ prefer concise answers
   - Long messages (>100 chars) â†’ prefer detailed explanations

2. **Formality level:**
   - Formal words: "xin", "áº¡", "dáº¡", "thÆ°a", "kÃ­nh"
   - Informal words: "nÃ¨", "nhÃ©", "á»«", "oke"

3. **Topic interests:**
   - Study keywords: "há»c", "Ä‘iá»ƒm", "thi", "Ã´n", "mÃ´n"
   - Goal keywords: "má»¥c tiÃªu", "káº¿ hoáº¡ch", "cáº§n", "muá»‘n"

**Stored in:** `users.preferences` JSON field

---

## ğŸ“Š REAL-TIME COMMUNICATION & WEBSOCKET

### 6.1. WebSocket Manager

**File:** `backend/core/websocket_manager.py`

**Technology:** Socket.IO (async mode with ASGI)

**Connection Management:**
```python
# Track connections
user_sessions: Dict[user_id â†’ Set[session_ids]]
session_users: Dict[session_id â†’ user_id]
```

**Event Handlers:**

1. **connect:** Client káº¿t ná»‘i
   - Extract user_id from auth
   - Track session
   - Send connection confirmation

2. **disconnect:** Client ngáº¯t káº¿t ná»‘i
   - Remove from tracking
   - Cleanup resources

3. **join_chat_session:** Join chat room
   - User joins specific chat session room
   - Receive messages for that session only

4. **leave_chat_session:** Leave chat room
   - User leaves session room

**Emit Functions:**

```python
# Emit to all sessions of a user
emit_to_user(user_id, event, data)

# Emit to specific session
emit_to_session(session_id, event, data)

# Broadcast to all clients
broadcast(event, data)
```

### 6.2. Real-time Events

**Frontend WebSocket Context:** `frontend_react/src/context/WebSocketContext.jsx`

**Events:**

1. **chat_message:** New chat message
   ```json
   {
     "session_id": "123",
     "role": "assistant",
     "message": "Xin chÃ o!"
   }
   ```

2. **chat_typing:** Typing indicator
   ```json
   {
     "session_id": "123",
     "is_typing": true
   }
   ```

3. **study_update:** Score updated
   ```json
   {
     "user_id": 1,
     "score": {...}
   }
   ```

4. **prediction_update:** New prediction available
   ```json
   {
     "user_id": 1,
     "predictions": [...]
   }
   ```

5. **notification:** General notification
   ```json
   {
     "type": "info",
     "message": "..."
   }
   ```

---

## ğŸ“ˆ MONITORING & OBSERVABILITY

### 7.1. Prometheus Metrics

**File:** `backend/core/metrics.py`

**HTTP Metrics:**
- `http_requests_total`: Counter by method/endpoint/status
- `http_request_duration_seconds`: Histogram of request latency
- `http_requests_in_progress`: Gauge of concurrent requests

**LLM Metrics:**
- `llm_requests_total`: Counter by provider/model/status
- `llm_request_duration_seconds`: LLM API latency
- `llm_tokens_total`: Token usage (input/output)
- `llm_errors_total`: Error count by type
- `llm_retries_total`: Retry count

**ML Metrics:**
- `ml_predictions_total`: Prediction count by model
- `ml_prediction_duration_seconds`: Prediction latency
- `ml_dataset_size`: Number of reference samples

**System Metrics:**
- `python_info`: Python version
- `process_cpu_seconds_total`: CPU time
- `process_resident_memory_bytes`: Memory usage

**Endpoint:** `http://backend:8000/metrics`

### 7.2. Structured Logging

**File:** `backend/core/logging_config.py`

**Format:** JSON logs via `python-json-logger`

**Fields:**
- timestamp
- level (INFO/WARNING/ERROR)
- logger name
- message
- extra context (user_id, endpoint, duration, etc.)

**Outputs:**
- Console (for Docker logs)
- Captured by Promtail â†’ Loki

### 7.3. Grafana Dashboards

**Location:** `grafana/dashboards/`

1. **edutwin-dashboard.json:**
   - HTTP request rate & latency
   - Error rate
   - LLM API usage & costs
   - ML prediction performance
   - Active users/sessions

2. **logs-dashboard.json:**
   - Log volume by level
   - Error logs table
   - Slow request alerts

**Access:** `http://localhost:3001` (default credentials: admin/admin)

---

## ğŸ” SECURITY & AUTHENTICATION

### 8.1. Authentication Flow

**Technology:** JWT (JSON Web Tokens)

**File:** `backend/api/auth.py`

**Endpoints:**
- `POST /auth/register`: Táº¡o tÃ i khoáº£n má»›i
- `POST /auth/login`: ÄÄƒng nháº­p â†’ nháº­n access token
- `GET /auth/me`: Láº¥y thÃ´ng tin user hiá»‡n táº¡i

**Password Security:**
- Hashing: bcrypt (cost factor: 12)
- Never store plaintext passwords
- Validate password strength

**Session Management:**
- Redis-based session storage
- Session timeout: configurable
- Session invalidation on logout

### 8.2. Authorization

**Roles:**
- `user`: Regular student (default)
- `developer`: Can access ML configuration
- `admin`: Full system access

**Protected Endpoints:**
- `@require_auth`: Requires valid JWT
- `@require_role("developer")`: Role-based access

**Frontend Protection:**
- ProtectedRoute component
- Redirect to login if unauthenticated
- Hide developer features from regular users

---

## ğŸš€ DEPLOYMENT

### 9.1. Docker Architecture

**File:** `docker-compose.yml`

**Services:**

1. **db** (PostgreSQL 15)
   - Port: 5432
   - Volume: postgres_data
   - Healthcheck enabled

2. **adminer** (Database UI)
   - Port: 8081
   - Web-based DB management

3. **redis** (Cache & Sessions)
   - Port: 6379

4. **backend** (FastAPI)
   - Port: 8000
   - Depends on: db, redis
   - Dev mode: Hot reload vá»›i volume mount
   - Prod mode: Gunicorn workers

5. **frontend** (React + Nginx)
   - Port: 3000
   - Dev mode: Vite dev server
   - Prod mode: Nginx serve static build

6. **prometheus** (Metrics)
   - Port: 9090
   - Scrape backend metrics

7. **grafana** (Dashboards)
   - Port: 3001
   - Pre-configured dashboards

8. **loki** (Log aggregation)
   - Port: 3100

9. **promtail** (Log shipper)
   - Collect Docker logs â†’ Loki

**Networks:** edutwin_network (bridge)

### 9.2. Environment Variables

**File:** `.env`

```bash
# Database
POSTGRES_DB=edutwin
POSTGRES_USER=edutwin_user
POSTGRES_PASSWORD=edutwin_password_2024
DATABASE_URL=postgresql://edutwin_user:edutwin_password_2024@db:5432/edutwin

# Redis
REDIS_URL=redis://redis:6379

# Security
SECRET_KEY=edutwin_2024_secure_key_32_chars_long_random_string_here

# Gemini API
LLM_PROVIDER=gemini
LLM_API_URL=https://generativelanguage.googleapis.com/v1beta/models/gemini-2.5-flash:generateContent
LLM_API_KEY=<your-gemini-api-key>
LLM_MODEL=gemini-2.5-flash
LLM_TIMEOUT_SECONDS=90

# Logging
LOG_LEVEL=INFO

# Frontend
VITE_API_URL=http://localhost:8000
VITE_WS_URL=http://localhost:8000/ws
```

### 9.3. Commands

**Development:**
```powershell
# Start all services
docker compose up -d

# View logs
docker compose logs -f backend

# Restart specific service
docker compose restart backend

# Stop all
docker compose down
```

**Production:**
```powershell
# Build production images
docker compose -f docker-compose.prod.yml build

# Deploy
docker compose -f docker-compose.prod.yml up -d
```

**Database migrations:**
```powershell
# Generate migration
docker compose exec backend alembic revision --autogenerate -m "description"

# Apply migrations
docker compose exec backend alembic upgrade head
```

---

## ğŸ“š API ENDPOINTS

### 10.1. Authentication
- `POST /auth/register` - ÄÄƒng kÃ½
- `POST /auth/login` - ÄÄƒng nháº­p
- `GET /auth/me` - ThÃ´ng tin user
- `POST /auth/logout` - ÄÄƒng xuáº¥t

### 10.2. User Profile
- `GET /user/profile` - Láº¥y profile
- `PUT /user/profile` - Cáº­p nháº­t profile
- `PUT /user/preferences` - Cáº­p nháº­t preferences

### 10.3. Study Scores
- `GET /study/scores` - Láº¥y táº¥t cáº£ Ä‘iá»ƒm
- `GET /study/scores/{id}` - Láº¥y Ä‘iá»ƒm cá»¥ thá»ƒ
- `POST /study/scores` - ThÃªm/cáº­p nháº­t Ä‘iá»ƒm
- `DELETE /study/scores/{id}` - XÃ³a Ä‘iá»ƒm
- `GET /study/structure` - Láº¥y cáº¥u trÃºc mÃ´n há»c
- `POST /study/update-score` - Cáº­p nháº­t Ä‘iá»ƒm Ä‘Æ¡n

### 10.4. Predictions
- `POST /study/predict` - Trigger prediction cho user
- `GET /study/predictions` - Láº¥y predictions

### 10.5. Chatbot
- `GET /chatbot/sessions` - Láº¥y danh sÃ¡ch chat sessions
- `POST /chatbot/sessions` - Táº¡o session má»›i
- `DELETE /chatbot/sessions/{id}` - XÃ³a session
- `GET /chatbot/sessions/{id}/messages` - Láº¥y messages
- `POST /chatbot/chat` - Gá»­i message
- `GET /chatbot/pending-updates` - Láº¥y pending confirmations
- `POST /chatbot/confirm-update/{id}` - Confirm update
- `POST /chatbot/cancel-update/{id}` - Cancel update

### 10.6. Learning Goals
- `GET /learning-goals` - Láº¥y danh sÃ¡ch má»¥c tiÃªu
- `POST /learning-goals` - Táº¡o má»¥c tiÃªu má»›i
- `PUT /learning-goals/{id}` - Cáº­p nháº­t má»¥c tiÃªu
- `DELETE /learning-goals/{id}` - XÃ³a má»¥c tiÃªu

### 10.7. Developer (Admin only)
- `POST /developer/upload-dataset` - Upload Excel dataset
- `GET /developer/dataset-summary` - Xem thá»‘ng kÃª dataset
- `POST /developer/run-pipeline` - Cháº¡y ML pipeline
- `POST /developer/evaluate-models` - ÄÃ¡nh giÃ¡ models
- `GET /developer/model-status` - Xem model hiá»‡n táº¡i
- `POST /developer/select-model` - Chá»n model (KNN/KR/LWLR)
- `GET /developer/parameters` - Láº¥y parameters
- `POST /developer/parameters` - Cáº­p nháº­t parameters

---

## ğŸ“ DOMAIN KNOWLEDGE

### 11.1. Score Classification

**File:** `backend/services/educational_knowledge.py`

```python
Äiá»ƒm 9.0-10.0: Xuáº¥t sáº¯c
Äiá»ƒm 8.0-8.9: Giá»i
Äiá»ƒm 6.5-7.9: KhÃ¡
Äiá»ƒm 5.0-6.4: Trung bÃ¬nh
Äiá»ƒm 3.5-4.9: Yáº¿u
Äiá»ƒm 0.0-3.4: KÃ©m
```

### 11.2. GPA Classification

```python
GPA 9.0-10.0: Xuáº¥t sáº¯c
GPA 8.0-8.9: Giá»i
GPA 6.5-7.9: KhÃ¡
GPA 5.0-6.4: Trung bÃ¬nh
GPA < 5.0: Yáº¿u
```

### 11.3. Subjects (9 mÃ´n)

```python
SUBJECTS = [
    "Toan",           # ToÃ¡n
    "Ngu van",        # Ngá»¯ vÄƒn
    "Vat ly",         # Váº­t lÃ½
    "Hoa hoc",        # HÃ³a há»c
    "Sinh hoc",       # Sinh há»c
    "Lich su",        # Lá»‹ch sá»­
    "Dia ly",         # Äá»‹a lÃ½
    "Tieng Anh",      # Tiáº¿ng Anh
    "Giao duc cong dan"  # GDCD
]
```

### 11.4. Grade Levels & Semesters

```python
GRADE_ORDER = ["10", "11", "12", "TN"]

SEMESTER_ORDER = {
    "10": ["1", "2"],
    "11": ["1", "2"],
    "12": ["1", "2"],
    "TN": ["TN"]  # Ká»³ thi tá»‘t nghiá»‡p
}
```

### 11.5. Exam Blocks (Khá»‘i thi)

```python
A00: ToÃ¡n, Váº­t lÃ½, HÃ³a há»c
B00: ToÃ¡n, HÃ³a há»c, Sinh há»c
C00: Ngá»¯ vÄƒn, Lá»‹ch sá»­, Äá»‹a lÃ½
D01: ToÃ¡n, Ngá»¯ vÄƒn, Tiáº¿ng Anh
```

---

## ğŸ“Š DATASET FORMAT

### 12.1. Excel Import Format

**File:** Upload qua Developer Dashboard

**Required columns:**
- Subject_Semester_Grade format
- Example: `Toan_1_10`, `Vat ly_2_11`, `Ngu van_TN_12`

**Valid values:**
- Scores: 0.0 - 10.0
- Empty cells: Skip

**Sample Excel structure:**
```
| Toan_1_10 | Toan_2_10 | Ly_1_10 | ... | Toan_TN_12 |
|-----------|-----------|---------|-----|------------|
| 8.5       | 8.7       | 7.2     | ... | 8.9        |
| 9.0       | 9.2       | 8.5     | ... | 9.1        |
```

### 12.2. Feature Data Structure

**Stored in:** `knn_reference_samples.feature_data` (JSON)

```json
{
  "Toan|1|10": 8.5,
  "Toan|2|10": 8.7,
  "Vat ly|1|10": 7.2,
  "Hoa hoc|1|10": 8.0,
  ...
  "Toan|TN|12": 8.9
}
```

---

## ğŸ”§ CONFIGURATION & TUNING

### 13.1. ML Model Parameters

**Adjustable via Developer Dashboard:**

1. **KNN:**
   - `knn_n`: Number of neighbors (default: 15)
   - Range: 1-50
   - Recommendation: 10-20 for small datasets

2. **Kernel Regression:**
   - `kr_bandwidth`: Gaussian kernel sigma (default: 1.25)
   - Range: 0.1-5.0
   - Higher = smoother predictions

3. **LWLR:**
   - `lwlr_tau`: Window size control (default: 3.0)
   - Range: 0.5-10.0
   - Higher = more local, lower = more global

**Versioning:**
- Each parameter change increments version
- Users marked for re-prediction when version changes
- ML version tracking ensures consistency

### 13.2. LLM Configuration

**Gemini API Settings:**
- Temperature: 0.2 (deterministic)
- Max output tokens: 8096
- Timeout: 90 seconds
- Max retries: 3
- Concurrency limit: 6

**Customizable in code:**
- `backend/services/llm_provider.py`
- Adjust temperature for creativity
- Increase timeout for complex queries

---

## ğŸ¯ KEY FEATURES SUMMARY

1. âœ… **Machine Learning Predictions**
   - 3 models: KNN, Kernel Regression, LWLR
   - Real-time predictions
   - Model comparison & evaluation
   - Parameter tuning

2. âœ… **AI Chatbot**
   - Gemini 2.5 Flash integration
   - Intent detection
   - Score updates via chat
   - Profile editing via chat
   - Personalization learning

3. âœ… **Data Visualization**
   - Multi-chart support (Line, Bar, Radar)
   - Actual vs Predicted comparison
   - Benchmark analysis
   - Progress tracking

4. âœ… **Real-time Updates**
   - WebSocket communication
   - Live notifications
   - Typing indicators
   - Multi-session sync

5. âœ… **Developer Tools**
   - Dataset upload (Excel)
   - Model evaluation metrics
   - Pipeline management
   - Parameter configuration

6. âœ… **Monitoring**
   - Prometheus metrics
   - Grafana dashboards
   - Structured logging
   - Performance tracking

7. âœ… **Security**
   - JWT authentication
   - Role-based access
   - Password hashing (bcrypt)
   - Session management

---

## ğŸ“– REFERENCES

### Technologies Used:
- **Frontend:** React, Vite, Chart.js, Recharts, Socket.IO
- **Backend:** FastAPI, SQLAlchemy, PostgreSQL, Redis
- **ML:** scikit-learn, numpy, scipy, pandas
- **AI:** Google Gemini API
- **DevOps:** Docker, Docker Compose
- **Monitoring:** Prometheus, Grafana, Loki, Promtail

### Documentation:
- FastAPI: https://fastapi.tiangolo.com/
- React: https://react.dev/
- Gemini API: https://ai.google.dev/
- Socket.IO: https://socket.io/
- scikit-learn: https://scikit-learn.org/

---

**TÃ i liá»‡u nÃ y Ä‘Æ°á»£c táº¡o tá»± Ä‘á»™ng tá»« source code cá»§a EduTwin.**  
**NgÃ y táº¡o:** November 30, 2025  
**PhiÃªn báº£n:** 1.0.0
